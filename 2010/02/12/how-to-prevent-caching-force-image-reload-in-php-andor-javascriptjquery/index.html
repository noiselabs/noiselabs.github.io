
<head>
    <meta charset="utf-8">

    <title>How to prevent caching (force image reload) in PHP and/or JavaScript/jQuery</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../../../../assets/images/favicon.ico?v=4d16522b1c">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?subset=latin,cyrillic-ext,latin-ext,cyrillic&amp;family=Open+Sans+Condensed:300%7COpen+Sans:400,600,400italic,600italic%7CMerriweather:400,300,300italic,400italic,700,700italic%7CRoboto+Slab:400,300%7CSource+Sans+Pro:200,300,400,600,700,900">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../assets/css/highlightjs-github.min.css?v=4d16522b1c">
    <link rel="stylesheet" href="../../../../assets/css/style.css?v=4d16522b1c">

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="Noiselabs">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How to prevent caching (force image reload) in PHP and/or JavaScript/jQuery">
    <meta property="og:description" content="If you are using images generated on-the-fly by a PHP script (or another server language), like I'm doing on my web application, you surely do not want images to be read from cache as your users will be seeing the same first generated image (saved into cache) and not the">
    <meta property="og:url" content="https://noiselabs.io/2010/02/12/how-to-prevent-caching-force-image-reload-in-php-andor-javascriptjquery/">
    <meta property="article:published_time" content="2010-02-12T19:11:00.000Z">
    <meta property="article:modified_time" content="2014-03-23T00:29:02.188Z">
    <meta property="article:tag" content="PHP">
    <meta property="article:tag" content="JavaScript">
    <meta property="article:tag" content="jQuery">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="How to prevent caching (force image reload) in PHP and/or JavaScript/jQuery">
    <meta name="twitter:description" content="If you are using images generated on-the-fly by a PHP script (or another server language), like I'm doing on my web application, you surely do not want images to be read from cache as your users will be seeing the same first generated image (saved into cache) and not the">
    <meta name="twitter:url" content="https://noiselabs.io/2010/02/12/how-to-prevent-caching-force-image-reload-in-php-andor-javascriptjquery/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Vítor Brandão">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="PHP, JavaScript, jQuery">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Noiselabs",
    "author": {
        "@type": "Person",
        "name": "Vítor Brandão",
        "image": "https://noiselabs.io/content/images/2016/04/green-2.jpg",
        "url": "https://noiselabs.io/author/vitor-brandao/",
        "sameAs": "https://twitter.com/noiselabs"
    },
    "headline": "How to prevent caching (force image reload) in PHP and/or JavaScript/jQuery",
    "url": "https://noiselabs.io/2010/02/12/how-to-prevent-caching-force-image-reload-in-php-andor-javascriptjquery/",
    "datePublished": "2010-02-12T19:11:00.000Z",
    "dateModified": "2014-03-23T00:29:02.188Z",
    "keywords": "PHP, JavaScript, jQuery",
    "description": "If you are using images generated on-the-fly by a PHP script (or another server language), like I&#x27;m doing on my web application, you surely do not want images to be read from cache as your users will be seeing the same first generated image (saved into cache) and not the"
}
    </script>

    <meta name="generator" content="Ghost 0.7">
    <link rel="alternate" type="application/rss+xml" title="Noiselabs" href="../../../../rss/index.rss">

    <script src="../../../../assets/js/vendor/modernizr.js?v=4d16522b1c"></script>
</head>
<body class="post-template tag-php tag-javascript tag-jquery">
    


    <div class="reading-time-indicator js-post-sticky-header">
        <div class="post-reading-time js-post-reading-time">
            <div class="percent js-percent-count">0%</div>
            <progress value="0" class="read-progress-indicator single">
                <div class="progress-container">
                    <span class="progress-bar"></span>
                </div>
            </progress>
            <div class="read-estimation">
                <div class="reading-time-blog-logo">
                    <a class="blog-logo" href="../../../../"><i class="fa fa fa-chevron-left"></i></a>
                </div>
                <div class="read-estimation-content">
                    <div class="title">How to prevent caching (force image reload) in PHP and/or JavaScript/jQuery</div>
                    <div class="estimated-time">
                        <span class="js-word-count"></span> words - <span class="eta"></span> read.
                    </div>
                </div>
            </div>
        </div>
    </div>

<nav class="main-nav">
    <a href="../../../../" class="header-back-btn js-bg-check left">
        Noiselabs
    </a>
    <i class="fa fa-fw fa-search main-nav-ico js-bg-check js-open-search right"></i></nav>
<header class="post-view-header js-blog-bg-image no-cover">
    <div class="post-header-content">
        <h1 class="post-title js-bg-check">How to prevent caching (force image reload) in PHP and/or JavaScript/jQuery</h1>
        <section class="post-meta js-bg-check">
            <time class="post-date" datetime="2010-02-12">12 February 2010</time>
        </section>
    </div>
</header>

<main class="post-view-content" role="main">

    <article class="post tag-php tag-javascript tag-jquery">

        <section class="post-content row">
            <div class="small-12 columns"><p>If you are <strong>using images generated on-the-fly by a PHP script</strong> (or another server language), like I'm doing on my web application, you surely do not want images to be read from cache as your users will be seeing the same first generated image (saved into cache) and not the new generated versions.</p>

<p>You can play with some header commands and build a function like this...</p>

<pre><code>function cacheKiller() {
    header("Cache-Control: no-cache, must-revalidate");
    header("Expires: Mon, 26 Jul 1997 05:00:00 GMT\n");
    header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
}
</code></pre>

<p>...but this will work for the whole page and not only for images.</p>

<p>So, to make sure the images shown are always up-to-date the simple way is to add a query section with a random number to the image URL in order to make the browser think that this is a different image, while keeping the same name.</p>

<h3 id="php">PHP</h3>

<p>In PHP it works like this:</p>

<pre><code>// Generate a number that will never be repeated using the time function
// that "returns the current time measured in the number of seconds since
// the Unix Epoch (January 1 1970 00:00:00 GMT)"
$cachekiller = time();

// Include the generated number in the image URL
&lt;img src="path/to/image.png?{$cachekiller}"&gt;&lt;/pre&gt;
</code></pre>

<h3 id="javascriptjquery">JavaScript / jQuery</h3>

<p>If the image URL is built using JavaScript/jQuery the Math function is good choice to generate a random number.</p>

<pre><code>// Generate random number between 1 and 1000.
var cachekiller = Math.floor(Math.random()*1001);

$("#thumbnail").attr("src", "path/to/image.png?"+cachekiller);
</code></pre></div>
        </section>

        <footer class="post-footer row">
            <div class="small-12 columns">
                <section class="post-tags">
                    Tags: <a href="../../../../tag/php/">PHP</a>, <a href="../../../../tag/javascript/">JavaScript</a>, <a href="../../../../tag/jquery/">jQuery</a>
                </section>

                <section class="share">
                    <h5>Share this post:</h5>
                    <a class="icon-twitter" href="https://twitter.com/share?text=How%20to%20prevent%20caching%20(force%20image%20reload)%20in%20PHP%20and%2For%20JavaScript%2FjQuery&amp;url=https://noiselabs.io/2010/02/12/how-to-prevent-caching-force-image-reload-in-php-andor-javascriptjquery/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                        <span class="hidden"><i class="fa fa-twitter-square"></i></span>
                    </a>
                    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://noiselabs.io/2010/02/12/how-to-prevent-caching-force-image-reload-in-php-andor-javascriptjquery/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                        <span class="hidden"><i class="fa fa-facebook-square"></i></span>
                    </a>
                    <a class="icon-google-plus" href="https://plus.google.com/share?url=https://noiselabs.io/2010/02/12/how-to-prevent-caching-force-image-reload-in-php-andor-javascriptjquery/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                        <span class="hidden"><i class="fa fa-google-plus-square"></i></span>
                    </a>
                </section>
            </div>
        </footer>

        <div class="row post-prev-next-pagination">
            <div class="prev small-6 columns text-left">
                    <div class="prev-next-label">
                        <a href="../../../../2009/03/31/howto-gentoo-linux-with-utf-8-and-portuguese-portugal-localization/">
                            <i class="fa fa-angle-double-left"></i> Previous
                        </a>
                    </div>
                    <a href="../../../../2009/03/31/howto-gentoo-linux-with-utf-8-and-portuguese-portugal-localization/" class="title">
                        Howto Gentoo Linux with UTF-8 and Portuguese (Portugal) localization
                    </a>
            </div>
            <div class="next small-6 columns text-right">
                    <div class="prev-next-label">
                        <a href="../../18/check-utf-8-input-in-php-only-letters/">
                            Next <i class="fa fa-angle-double-right"></i>
                        </a>
                    </div>
                    <a href="../../18/check-utf-8-input-in-php-only-letters/" class="title">
                        Check UTF-8 input in PHP: only letters
                    </a>
            </div>
        </div>

            <section class="author-info">
                <div class="row">
                    <section class="post-author small-12 columns">
                            <img src="../../../../content/images/2016/04/green-2.jpg" class="post-author-avatar" alt="Vítor Brandão">
                            <span class="author-label">Author</span>
                            <h1><a href="../../../../author/vitor-brandao/" class="author-link-name">Vítor Brandão</a></h1>
                            <p><a href="https://twitter.com/noiselabs" class="author-website">https://twitter.com/noiselabs</a></p>
                    </section>
                </div>
            </section>

        <section class="disqus">
            <section class="disqus">
    <div class="row">
        <div class="small-12 columns">
            <h2 class="comments-header">Comments</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'noiselabs'; // required: replace example with your forum shortname

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </div>
</section>
        </section>

    </article>

</main>



    <footer class="site-footer">
    <div class="row expanded">
        <div class="small-6 columns align-justify">
            <ul class="no-bullet">
                <li>© 2016 <a href="mailto:vitor@noiselabs.org">Vítor Brandão</a>. All rights reserved.</li>
                <li>Based on the ABC theme by <a href="http://pxt.be">pxt.be</a></li>
                <li>Proudly published with <a href="https://ghost.org">Ghost</a></li>
            </ul>
        </div>
        <div class="small-6 columns align-justify text-right">
        </div>
    </div>
</footer>
    <div class="big-search">
    <i class="fa fa-times-circle big-search-close-btn js-close-search"></i>
    <div class="big-search-container">
        <div class="row">
            <div class="small-12 columns">
                <form class="big-search-form">
                    <input class="big-search-form-input js-search-input" type="text" placeholder="Search...">
                </form>
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
                <div class="big-search-results js-search-results"></div>
            </div>
        </div>
    </div>
</div>

    <div class="back-to-top js-back-to-top-btn hidden">
        <i class="fa fa-angle-up"></i>
    </div>

    

    <script type="text/javascript" src="../../../../assets/js/vendor/jquery-2.1.4.min.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/vendor/foundation.min.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/vendor/background-check.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/vendor/ghost-hunter.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/vendor/images-loaded.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/vendor/reading-time.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/vendor/highlight.min.js?v=4d16522b1c"></script>
    <script type="text/javascript" src="../../../../assets/js/abc.js?v=4d16522b1c"></script>

</body>
